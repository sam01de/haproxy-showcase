defaults
    mode http
    #mode tcp => TCP Connection stays alive

frontend web
    bind *:80
    timeout client 60s
    
    # ACL to detect admin path and block it
    acl is_admin path_beg /proxytest/admin
    http-request deny if is_admin
    
    # ACL to detect server5 path and route to specific backend  
    acl is_server5 path_end /proxytest/server5
    use_backend server5_only if is_server5
    
    default_backend apps

backend apps
    timeout connect 10s
    timeout server 10s
    balance roundrobin
    #balance leastconn
    #balance source
    server app1 app1:3000 check
    server app2 app2:3000 check
    server app3 app3:3000 check
    server app4 app4:3000 check
    server app5 app5:3000 check

# Backend for server5 specific routing
backend server5_only
    timeout connect 10s
    timeout server 10s
    server app5 app5:3000 check

listen stats
    bind *:8404
    stats enable
    stats uri /
